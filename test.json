modified in master, merged with test

